url = "/csapat/:id/:action?"
layout = "default"
title = "Csapat"

[basicForm]
formSlug = "csapat"
recordKeyParam = "id"
recordActionParam = "action"
createRecordKeyword = "letrehozas"
actionUpdateKeyword = "modositas"
actionDeleteKeyword = "torles"

[builderList]
modelClass = "Csatar\Csatar\Models\Troop"
scope = "scopeTeamId"
scopeValue = "{{ :id }}"
displayColumn = "name"
noRecordsMessage = "backend::lang.list.no_records"
detailsPage = "raj"
detailsKeyColumn = "id"
detailsUrlParameter = "id"
pageNumber = "{{ :page }}"

[builderList builderList2]
modelClass = "Csatar\Csatar\Models\Patrol"
scope = "-"
scopeValue = "{{ teamId }}"
displayColumn = "name"
noRecordsMessage = "No records found"
detailsPage = "ors"
detailsKeyColumn = "id"
detailsUrlParameter = "id"
pageNumber = "{{ :page }}"

[viewBag]
localeTitle[en] = "Team"
localeTitle[hu] = "Csapat"
==
<?php
public function onStart() {
    $this['month'] = date('n');

    $team = Csatar\Csatar\Models\Team::getById($this->param('id'));
    $this['associationId'] = $team->district->association_id;
    $this['teamNumber'] = $team->team_number;
}
?>
==
<div class="container">
    {% component 'basicForm' %}

    <p>{{ 'Rajok' | _ }}</p>
    {% component 'builderList' %}

    <p><a href="/raj/letrehozas" class="btn btn-default">{{ 'Raj hozzáadása' | _ }}</a></p>

    <p>{{ 'Őrsök' | _ }}</p>
    {% component 'builderList2' %}

    <p><a href="/ors/letrehozas" class="btn btn-default">{{ 'Őrs hozzáadása' | _ }}</a></p>
    
    {% if month == 1 or month == 12 %}
        <p><a href="{{ '/csapatjelentes/' ~ associationId ~ '/' ~ teamNumber }}" class="btn btn-default">{{ 'Csapatjelentés létrehozása' | _ }}</a></p>
    {% endif %}
</div>
