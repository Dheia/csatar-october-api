[structure structure_menu]
mode = "menu"
==
<?php
use Csatar\Csatar\Classes\AccidentLogRigthsProvider;

function onStart()
{
    $this['ecset_code'] = isset(Auth::user()->scout->ecset_code) ? Auth::user()->scout->ecset_code : null;
    if ($user = Auth::user()) {
        $this['isAccidentLogUser'] = AccidentLogRigthsProvider::isAccidentLogUser($user);
        $this['inAccidentLogEntryGroup'] = AccidentLogRigthsProvider::inAccidentLogEntryGroup($user);
        $this['inAccidentLogAdminGroup'] = AccidentLogRigthsProvider::inAccidentLogAdminGroup($user);
    }
}
?>
==
<div id="header">
    <div class="bg-white d-flex justify-content-center fixed-top">
        <div class="bg-primary py-2 rounded-bottom" style="width:97%">
            <div class="row">

                {# logo #}
                <div class="col-2 col-sm-1 col-md-2 col-lg-1 order-1 order-md-1 d-flex justify-content-center mb-2 mb-lg-0">
                    <a href={{ url('/') }}><img class="ps-5" src="{{ 'assets/images/csatar_logo.svg' | theme }}" alt="{{ 'CSATÁR' | _ }}" height="40px"></a>
                </div>

                {# nav #}
                <div class="col-1 col-sm-1 col-md-6 col-lg-6 order-2 order-md-2 pt-1 text-light">
                    <nav class="navbar navbar-expand-md navbar-dark m-0 p-0">
                        <div class="container-fluid">
                            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWithBackdrop" aria-controls="offcanvasWithBackdrop">
                            <span class="navbar-toggler-icon"></span>
                            </button>
                            
                            <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasWithBackdrop" aria-labelledby="offcanvasWithBackdropLabel">
                                <div class="offcanvas-header">
                                    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                                </div>
                                <div class="offcanvas-body rounded-top-right bg-primary">
                                    <a href={{ url('/') }}><img class="mb-2 d-block d-md-none" src="{{ 'assets/images/csatar_logo.svg' | theme }}" alt="{{ 'CSATÁR' | _ }}" height="60px"></a>
                                    <hr class="hr-single bg-gray d-block d-md-none">
                                    <ul class="navbar-nav">
                                        <li class="nav-item dropdown">
                                            <a class="nav dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">{{ 'Tagnyilvántartás' | _ }}</a>
                                            <ul class="dropdown-menu bg-primary">
                                                {% if user %}
                                                <li class="nav-item">
                                                    <a class="dropdown-item" href="/csapat/{{ user.scout.team_id }}">{{ 'Tagnyilvántartás' | _ }}</a>
                                                </li>
                                                {% else %}
                                                <li class="nav-item">
                                                    <a class="dropdown-item" href="/bejelentkezes">{{ 'Tagnyilvántartás' | _ }}</a>
                                                </li>
                                                {% endif %}
                                                <li>
                                                    <a class="dropdown-item" href="/tag-lekerdezes">{{ 'Tag lekérdezés' | _ }}</a>
                                                </li>
                                            </ul>
                                        </li>

                                        {% component 'structure_menu' %}

                                        {% if isAccidentLogUser %}
                                            <li class="nav-item dropdown">
                                                <a class="nav dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">{{ 'Balesetek' | _ }}</a>
                                                <ul class="dropdown-menu bg-primary">
                                                    <li>
                                                        <a class="dropdown-item" href="/baleset/letrehozas">{{ 'Új baleset' | _ }}</a>
                                                    </li>
                                                    {% if inAccidentLogAdminGroup %}
                                                    <li class="nav-item">
                                                        <a class="dropdown-item" href="/balesetek">{{ 'Adatok' | _ }}</a>
                                                    </li>
                                                    {% endif %} 
                                                </ul>
                                            </li>
                                        {% endif %}
                                        
                                        {% if user %}
                                        <li class="nav-item">
                                            <a class="nav" href="/csapatjelentesek/elfogadasravaro">{{ 'Csapatjelentések' | _ }}</a>
                                        </li>
                                        {% endif %}
                                        <li class="nav-item">
                                            <a class="nav" href="/tamogatok">{{ 'Támogatók' | _ }}</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav" href="/kapcsolat">{{ 'Kapcsolat' | _ }}</a>
                                        </li>
                                    </ul>

                                    {# search #}
                                    <div class="col-12 col-md-9 col-lg-3 order-4 order-md-3 order-lg-3 pt-5 pt-lg-0 text-light">
                                        <div class="ms-auto px-2 px-md-5 px-lg-3">
                                            <form action="{{ 'kereses-erdmenyek' | page }}" method="get">
                                                <div class="input-group rounded bg-light">
                                                <input type="search" name="q"
                                                    class="form-control rounded bg-light border-0"
                                                    placeholder="{{ 'Keresés' | _ }}"
                                                    aria-label="Search"
                                                    aria-describedby="search-addon" />
                                                <span>
                                                    <button class="search-btn" type="submit">
                                                    <i class="csat-magnif-fill-sm"></i>
                                                    </button>
                                                </span>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </nav>
                </div>

                {# search #}
                <div class="col-12 col-md-9 col-lg-3 order-4 order-md-3 order-lg-3 pt-2 pt-lg-0 text-light">
                    <div class="ms-auto px-2 px-md-5 px-lg-3">
                        <form action="{{ 'kereses-erdmenyek' | page }}" method="get">
                            <div class="input-group rounded bg-light">
                            <input type="search" name="q"
                                class="form-control rounded bg-light border-0"
                                placeholder="{{ 'Keresés' | _ }}"
                                aria-label="Search"
                                aria-describedby="search-addon" />
                            <span>
                                <button class="search-btn" type="submit">
                                <i class="csat-magnif-fill-sm"></i>
                                </button>
                            </span>
                            </div>
                        </form>
                    </div>
                </div>

                {# controls #}
                <div class="col-9 col-sm-10 col-md-3 col-lg-2 order-3 order-md-4 d-flex pt-1 pt-md-3 pt-lg-1 pe-4 text-light justify-content-end">
                    {% if user %}
                    <a href="/elfelejtett-jelszo" class="btn controls" type="button">
                        <i class="csat-gear-out-wh-md"></i>
                    </a>
                    <a href="/tag/{{ ecset_code}}" class="btn controls" type="button">
                        {% if user.scout.gender == 1 %}
                            <i class="csat-male-out-wh-md"></i>
                        {% elseif user.scout.gender == 2 %}
                            <i class="csat-female-out-wh-md"></i>
                        {% else %}
                            <i class="csat-user-out-wh-md"></i>
                        {% endif %}
                    </a>

                    <a class="btn controls" data-bs-toggle="modal" data-bs-target="#twoFactorAuthModal">
                        <i class="csat-key-out-wh-md"></i>
                    </a>

                    <a data-request="onLogout" data-request-data="redirect: '/bejelentkezes'" class="btn controls" type="button">
                        <i class="csat-exit-out-wh-md"></i>
                    </a>
                    {% else %}
                    <a href="/bejelentkezes" class="btn controls" type="button">
                        <i class="csat-user-out-wh-md"></i>
                    </a>
                    {% endif %}
                </div>

            </div>
        </div>
    </div>
</div>

{% component 'twoFactorAuthentication' %}